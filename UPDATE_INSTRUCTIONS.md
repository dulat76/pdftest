# Инструкция по обновлению проекта

## Обновление файлов на сервере

```bash
# 1. Перейти в директорию проекта
cd /home/ubuntu/predmet_kz/flask_app

# 2. Сохранить локальные изменения (если есть)
git stash

# 3. Получить обновления из Git
git pull origin master

# 4. Если были сохранены изменения, применить их обратно (опционально)
git stash pop
```

## Применение миграций БД

```bash
# 1. Активировать виртуальное окружение
source venv/bin/activate

# 2. Применить миграции Alembic
alembic upgrade head

# ВАЖНО: Если в БД есть существующие записи пользователей, нужно будет:
# - Заполнить first_name, last_name, email для существующих пользователей
# - Это можно сделать через SQL или через админ-панель
```

## Обновление зависимостей (если нужно)

```bash
# Установить новые зависимости (если они были добавлены)
pip install -r requirements.txt
```

## Перезапуск приложения

```bash
# Если используется systemd
sudo systemctl restart flask_app

# Проверить статус
sudo systemctl status flask_app

# Посмотреть логи
sudo journalctl -u flask_app -f
```

## Проверка работы

1. Откройте админ-панель: `https://docquiz.predmet.kz/admin/teachers`
2. Проверьте, что форма создания учителя содержит поля: Фамилия, Имя, Email
3. Проверьте autocomplete для города и школы
4. Проверьте создание предмета с выбором классов

## Важные замечания

- **Миграция БД обязательна** - без неё новые поля не будут работать
- Для существующих пользователей нужно заполнить first_name, last_name, email
- Email должен быть уникальным для каждого пользователя

